ECA Rule rs1_eca ACTION_LOCAL_SEND<matchingPacket(@Switch, SrcAdd, DstAdd, Data, TopPriority)> :- EVENT_RECV<packet(@Switch, SrcAdd, DstAdd, Data)>, device(@Switch, Dvtype), maxPriority(@Switch, TopPriority), Dvtype == 0.
ECA Rule rs2_eca ACTION_LOCAL_SEND<matchingPacket(@Switch, SrcAdd, DstAdd, Data, NextPriority)> :- EVENT_RECV<matchingPacket(@Switch, SrcAdd, DstAdd, Data, Priority)>, device(@Switch, Dvtype), flowEntry(@Switch, DstEntry, Next, Priority), Priority > 0, DstAdd != DstEntry, NextPriority := Priority- 1, Dvtype == 0.
ECA Rule rs3_eca ACTION_REMOTE_SEND<packet(@Next, SrcAdd, DstAdd, Data)> :- EVENT_RECV<matchingPacket(@Switch, SrcAdd, DstAdd, Data, Priority)>, device(@Switch, Dvtype), flowEntry(@Switch, DstEntry, Next, Priority), link(@Switch, Next), Priority > 0, DstAdd == DstEntry, Dvtype == 0.
ECA Rule rs4_eca ACTION_REMOTE_SEND<packet(@Next, SrcAdd, DstAdd, Data)> :- EVENT_RECV<matchingPacket(@Switch, SrcAdd, DstAdd, Data, Priority)>, device(@Switch, Dvtype), flowEntry(@Switch, DstAdd, Next, Priority), link(@Switch, Next), Priority == 0, Dvtype == 0.
ECA Rule rh1Eca0Ins ACTION_REMOTE_SEND<packet(@Switch, SrcAdd, DstAdd, Data)> :- EVENT_INSERT<device(@Host, Dvtype)>, initPacket(@Host, SrcAdd, DstAdd, Data), linkhr(@Host, Switch), Dvtype == 1.
ECA Rule rh1Eca1Ins ACTION_REMOTE_SEND<packet(@Switch, SrcAdd, DstAdd, Data)> :- EVENT_INSERT<initPacket(@Host, SrcAdd, DstAdd, Data)>, device(@Host, Dvtype), linkhr(@Host, Switch), Dvtype == 1.
ECA Rule rh1Eca2Ins ACTION_REMOTE_SEND<packet(@Switch, SrcAdd, DstAdd, Data)> :- EVENT_INSERT<linkhr(@Host, Switch)>, device(@Host, Dvtype), initPacket(@Host, SrcAdd, DstAdd, Data), Dvtype == 1.
ECA Rule rh2_eca ACTION_ADD<recvPacket(@Host, SrcAdd, DstAdd, Data)> :- EVENT_RECV<packet(@Host, SrcAdd, DstAdd, Data)>, device(@Host, Dvtype), Dvtype == 1.
